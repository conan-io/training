version: "3.5"

services:
    conan-training:
        container_name: conan-training${COURSE_SUFFIX}
        build:
            dockerfile: Dockerfile
            context: ./conan-training
        env_file:
            - .creds.env
        networks:
            - primary
        volumes:
           - type: bind
             source: ../
             target: /home/conan/training
        command: tail -f /dev/null

    jfrog-artifactory-training:
        container_name: jfrog-artifactory-training${COURSE_SUFFIX}
        build:
            dockerfile: Dockerfile
            context: ./artifactory-training
        env_file:
            - .creds.env
        networks:
            primary:
                aliases: 
                    - artifactory
        volumes:
           - type: bind
             source: ./opt/jfrog/artifactory/var
             target: /opt/jfrog/artifactory/var
           - type: bind
             source: ./scripts
             target: /scripts
        ports:
            - "8082:8082"
        restart: always
networks:
    primary:
